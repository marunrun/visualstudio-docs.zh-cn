---
title: 测试区域3：签出-撤消签出 |Microsoft Docs
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- source control plug-ins, checkout
- source control plug-ins, undo checkout
- source control [Visual Studio SDK], checking out
- source control [Visual Studio SDK], undo checkout
ms.assetid: ce00c5a5-d472-4f45-8776-d77a1fbe9d37
author: madskristensen
ms.author: madsk
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: 44abff5adedf8e0cccfb0d5e44486aaa8f36ff12
ms.sourcegitcommit: 5f6ad1cefbcd3d531ce587ad30e684684f4c4d44
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/22/2019
ms.locfileid: "72722566"
---
# <a name="test-area-3-check-outundo-checkout"></a>测试区域3：签出/撤消签出
此源代码管理插件测试区域介绍了如何通过 "**签出**" 和 "**撤消签**出" 命令从版本存储区中编辑和还原项。

**签出**：将版本存储区中的项标记为已签出，将本地副本修改为读/写。

**撤消签出**：将版本存储区中的项标记为已签入，并在签出之前恢复本地副本状态（具体取决于选项）。

## <a name="command-menu-access"></a>命令菜单访问

以下 [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] 集成开发环境菜单路径在测试用例中使用。

##### <a name="check-out"></a>退房：

- **文件**、**源代码管理**和**签出**。

- **文件**，请**参阅**。

- 快捷菜单中的 "**签出**"。

- 撤消签出：**文件**、**源代码管理**、**撤消签出**。

## <a name="common-expected-behavior"></a>常见的预期行为

- 执行签出操作后，目标文件和/或文件夹将在版本存储区中标记为已签出。

- 版本存储将签出到正确的用户。

- 结帐的时间和日期是正确的（根据用户的设置）。

## <a name="test-cases"></a>测试用例

下面是用于签出/撤消签出测试区域的特定测试用例。

### <a name="case-3a-check-out"></a>Case 3a：检查

本部分重点介绍签出命令的操作。

|操作|测试步骤|要验证的预期结果|
|------------|----------------|--------------------------------|
|查看专用（COE）客户端项目|1. 创建客户端项目。<br />2. 将解决方案添加到源代码管理。<br />3. 以独占方式签出整个项目（"**文件**"、"**查看**"）。|检查发生。|
|查看专用（COE）文件系统或本地 IIS Web 项目|1. 将 Web 服务器连接设置为 "**工具**"、"**选项**"、"**项目**" 和 " **Web 设置**"。<br />2. 创建 Web 项目。<br />3. 将解决方案添加到源代码管理。<br />4. 以独占方式检查整个项目（**文件**、**源代码管理**和**签出**）。|检查发生。|
|查看解决方案中的解决方案项（处理其他文件的新方法）|1. 创建空白解决方案。<br />2. 将解决方案添加到源代码管理。<br />3. 查看解决方案。<br />4. 添加若干解决方案项。<br />5. 检查所有新添加的项。<br />6. 选择多个解决方案项。<br />7. 查看选定项（快捷菜单，**查看**）。|选择的文件已签出。|
|签出本地版本（如果受测插件支持此功能）|1. 用户1：创建客户端项目。<br />2. 用户1：将解决方案添加到源代码管理。<br />3. 用户2：从源代码管理打开解决方案到其他位置。<br />4. 用户2：签出文件。<br />5. 用户2：修改文件。<br />6. 用户2：签入文件。<br />7. 用户1：查看文件的本地版本（检查 "签**出**" 对话框中的 "**签出本地版本**高级" 选项）。|文件的本地版本已签出。<br /><br /> 用户2所做的修改不适用于用户1文件。|

### <a name="case-3b-disconnected-check-out"></a>Case 3b：断开连接签出

在断开连接模式下操作时，用户可以在不直接连接到版本存储区时，为用户提供一定程度的持续源代码管理支持。 这是通过在本地缓存有关已登记解决方案和项目的所有相关信息来完成的。

仅当连接到源代码管理存储时，才可以进行排他签出操作。 无论是连接还是断开连接，都可以随时执行共享的签出操作。 因此，当从版本存储区断开连接时，只会启用 "**签出共享**（COS）" 命令。 断开连接时，由于无法检索旧版本来替换用户所做的更改，**撤消签出**已禁用。

当用户重新连接到版本存储区时，将同步所有已登记解决方案和项目的签出状态。 对于用户已执行的签出，此功能将执行所需的更新。 发生同步后，用户可以继续正常工作（已连接）。

#### <a name="expected-behavior"></a>预期行为

- 从版本存储区断开连接时，不能使用 "**仅签出**" 命令。

- 从版本存储区断开连接时，无法使用 "**撤消签出**" 命令。

- **共享签出**命令正常工作。

|操作|测试步骤|要验证的预期结果|
|------------|----------------|--------------------------------|
|断开连接时，请查看文件，然后连接进行同步|1. 使用 "更改源代码管理" 对话框（"**文件**"、"**源代码管理**"、"**更改源代码管理**"）断开受控项目的连接。<br />2. 签出文件。<br />3. 在警告对话框中单击 "签出（断开连接）"。<br />4. 编辑该文件。<br />5. 使用 "更改源代码管理" 对话框进行连接。<br />6. 获取编辑过的文件的最新版本。|常见的预期行为|

### <a name="case-3c-query-editquery-save-qeqs"></a>Case 3c：查询编辑/查询保存（QEQS）
 跟踪源代码管理下的项以便对其进行编辑、更改和保存，以帮助用户轻松管理其文件。 编辑 "签入" 的受控项后，QEQS 会截获所尝试的编辑，并询问用户是否要签出文件以进行编辑。 根据 "**工具**"、"**选项**" 设置，用户可能会被强制签出文件以进行编辑，或允许在内存中编辑副本并稍后查看。 如果用户的 "**工具**"、"**选项**" 设置未设置为显示 "签出" 对话框，而只是将其签出，则当用户进行编辑时，文件会在可能的情况下自动签出。

#### <a name="expected-behavior"></a>预期行为

- 执行签出操作后，目标文件和/或文件夹将在版本存储区中标记为已签出。

- 将签出到正确用户的版本存储区属性。

- 检查的时间和日期是正确的（根据用户的设置）。

- 目标文件或文件夹的本地副本是可写的。

|操作|测试步骤|要验证的预期结果|
|------------|----------------|--------------------------------|
|编辑签入的文本文件|1. 创建包含文本文件的新项目。<br />2. 将解决方案添加到源代码管理。<br />3. 设置**工具**、**选项**、**源代码管理**、**允许在磁盘上只读时编辑文件**以取消选中。<br />4. 在 "**编辑时签入文件**" 组合框中设置**工具**、**选项**、**源代码管理**和**提示签出**。<br />5. 在 "**签入文件已保存**" 组合框中设置 "**工具**"、"**选项**"、"**源代码管理**" 和 "**提示签出**"。<br />6. 在编辑器中打开文本文件，尝试在文件中键入新文本。 如果此步骤成功，则继续下一步。<br />7. 单击 "**签出以进行编辑**" 对话框中的 "**取消**"。 如果此步骤成功，则继续下一步。<br />8. 设置**工具**、**选项**、**源代码管理**，允许在要检查的**磁盘上只读时编辑文件**。<br />9. 在编辑器中打开项目文件，尝试在文件中键入新文本。 如果此步骤成功，则继续下一步。<br />10. 单击 "**签出以进行编辑**" 对话框中的 "**编辑**"。 如果此步骤成功，则继续下一步。<br />11. 编辑文本文件并尝试保存。|`Result of step 6:`<br /><br /> 此时将显示 "签出以进行编辑" 对话框。<br /><br /> `Result of step 7:`<br /><br /> 文件不变。<br /><br /> `Result of step 9:`<br /><br /> 此时将显示 "签出以进行编辑" 对话框。<br /><br /> `Result of step 10:`<br /><br /> 可以在内存中编辑项目文件。<br /><br /> `Result of step 11:`<br /><br /> 保存时，将显示 "签出时签出" 对话框。|
|编辑签入的解决方案文件|重复上述测试中所述的步骤，但不修改文本文件，只需更改解决方案属性即可修改解决方案。|与上一测试相同|
|编辑签入的项目文件|重复上述测试中所述的步骤，但不修改文本文件，而是通过更改项目属性来修改项目。|与上一测试相同。|

### <a name="case-3d-silent-check-out"></a>Case 3d：无提示签出
 此子区域涵盖了 "**签出**" 对话框未显示每个用户的**工具**、**选项**、**源代码管理设置**的情况。

#### <a name="expected-behavior"></a>预期行为

- 执行签出操作后，目标文件和/或文件夹将在版本存储区中标记为已签出。

- 将签出到正确用户的版本存储区属性。

- 检查的时间和日期是正确的（根据用户的设置）。

- 目标文件或文件夹的本地副本是可写的。

|操作|测试步骤|要验证的预期结果|
|------------|----------------|--------------------------------|
|文件的无提示签出|1. 将 "**工具**"、"**选项**"、"**源代码管理**" 设置为**在编辑时自动签出文件**。<br />2. 使用文件创建新的项目。<br />3. 将解决方案添加到源代码管理。<br />4. 查看文件。|文件以无提示方式签出（无 UI）。|
|项目的无提示签出|1. 将 "**工具**"、"**选项**"、"**源代码管理**" 设置为**在编辑时自动签出文件**。<br />2. 创建一个新项目。<br />3. 将解决方案添加到源代码管理。<br />4. 查看项目。|文件以无提示方式签出（无 UI）。|

### <a name="case-3e-undo-check-out"></a>Case 3e：撤消签出
 "**撤消签出**" 用于取消文件的已签出状态，并避免签入对该文件所做的更改。

#### <a name="expected-behavior"></a>预期行为

- 默认值基于用户的 "**签出本地版本**" 设置。 如果用户已选择签出本地版本，则 "撤消签出" 的默认值将始终还原到 "已签出" 版本。

- 接受撤消后，**解决方案资源管理器**中的图标将更新为受影响的文件，并从 "**挂起的签入**" 窗口中删除该项。

|操作|测试步骤|要验证的预期结果|
|------------|----------------|--------------------------------|
|撤消签出以独占方式签出的单个文件|1. 创建客户端项目。<br />2. 将解决方案添加到源代码管理。<br />3. 以独占方式签出文件。<br />4. 修改文件。<br />5. 撤消签出（**文件**、**源代码管理**、**撤消签出**）。|常见的预期行为。|
|撤消签出共享的单个文件|1. 创建客户端项目。<br />2. 将解决方案添加到源代码管理。<br />3. 查看共享的文件。<br />4. 修改文件。<br />5. 撤消签出（**文件**、**源代码管理**、**撤消签出**）。|常见的预期行为。|
|向项目中添加文件后撤消项目的签出|1. 创建一个新项目并将其添加到源代码管理。<br />2. 签出项目。<br />3. 将文件添加到项目。<br />4. 撤消项目的签出。|添加的文件将从解决方案资源管理器中的项目中删除。<br /><br /> 项目不再处于签出状态。|
|从项目中删除文件后撤消签出项目|1. 创建一个新项目并将其添加到源代码管理。<br />2. 签出项目。<br />3. 从项目中删除文件。<br />4. 撤消项目的签出。|删除的文件显示在解决方案资源管理器中的项目下。<br /><br /> 项目不再处于签出状态。|

## <a name="see-also"></a>请参阅
- [源代码管理插件的测试指南](../../extensibility/internals/test-guide-for-source-control-plug-ins.md)
